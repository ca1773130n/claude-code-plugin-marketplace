---
phase: 04-onboarding-automation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - templates/plugin-template/.claude-plugin/plugin.json
  - templates/plugin-template/agents/example-plugin-example-agent.md
  - templates/plugin-template/commands/example.md
  - templates/plugin-template/CLAUDE.md
  - templates/plugin-template/README.md
  - templates/plugin-template/CHANGELOG.md
  - templates/plugin-template/VERSION
  - scripts/validate-local.sh
autonomous: true
verification_level: sanity

must_haves:
  truths:
    - "Template directory at templates/plugin-template/ passes validate-plugin.sh (exit 0)"
    - "Template scores >= 90 on score-plugin.sh (stretch target; >= 40 is the hard requirement)"
    - "validate-local.sh runs both validation and scoring on any plugin directory and exits 0 for valid plugins"
    - "All template files use {{PLUGIN_NAME}} and {{PLUGIN_DESCRIPTION}} placeholders for later substitution"
    - "No sed -i, no Bash 4+ features, no GNU-specific flags in any script"
  artifacts:
    - path: "templates/plugin-template/.claude-plugin/plugin.json"
      provides: "Maximalist plugin manifest with all optional fields populated"
      contains: "example-plugin"
    - path: "templates/plugin-template/README.md"
      provides: "50+ line README template with placeholder sections"
      min_lines: 50
    - path: "templates/plugin-template/CLAUDE.md"
      provides: "Plugin development guidance file"
    - path: "templates/plugin-template/CHANGELOG.md"
      provides: "Initial changelog entry for version 1.0.0"
    - path: "templates/plugin-template/VERSION"
      provides: "Version file containing 1.0.0"
    - path: "templates/plugin-template/agents/example-plugin-example-agent.md"
      provides: "Example agent file establishing naming convention"
    - path: "templates/plugin-template/commands/example.md"
      provides: "Example command definition file"
    - path: "scripts/validate-local.sh"
      provides: "Local validation wrapper running validate + score"
  key_links:
    - from: "templates/plugin-template/.claude-plugin/plugin.json"
      to: "templates/plugin-template/agents/example-plugin-example-agent.md"
      via: "agents array path declaration"
      pattern: "agents.*example-plugin-example-agent"
    - from: "templates/plugin-template/.claude-plugin/plugin.json"
      to: "templates/plugin-template/commands/example.md"
      via: "commands array path declaration"
      pattern: "commands.*example\\.md"
    - from: "scripts/validate-local.sh"
      to: "scripts/validate-plugin.sh"
      via: "script invocation"
      pattern: "validate-plugin\\.sh"
    - from: "scripts/validate-local.sh"
      to: "scripts/score-plugin.sh"
      via: "script invocation"
      pattern: "score-plugin\\.sh"
---

<objective>
Create the plugin template scaffold directory and local validation wrapper script.

Purpose: The template provides a complete, high-scoring starting point for new plugin authors. Every file is pre-populated so that the scaffold passes validation out of the box and scores >= 90. The validate-local.sh wrapper gives contributors a single command to check their work before submitting a PR.

Output: `templates/plugin-template/` directory with 7 files across 3 subdirectories, plus `scripts/validate-local.sh`.
</objective>

<execution_context>
@${CLAUDE_PLUGIN_ROOT}/references/execute-plan.md
@${CLAUDE_PLUGIN_ROOT}/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-onboarding-automation/04-RESEARCH.md

# Existing validation/scoring scripts (for validate-local.sh integration)
@scripts/validate-plugin.sh
@scripts/score-plugin.sh

# Schema (for plugin.json field reference)
@schemas/plugin.schema.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create plugin template directory with all scaffold files</name>
  <files>
    templates/plugin-template/.claude-plugin/plugin.json,
    templates/plugin-template/agents/example-plugin-example-agent.md,
    templates/plugin-template/commands/example.md,
    templates/plugin-template/CLAUDE.md,
    templates/plugin-template/README.md,
    templates/plugin-template/CHANGELOG.md,
    templates/plugin-template/VERSION
  </files>
  <action>
    Create the template scaffold directory at `templates/plugin-template/` with these files:

    1. **`templates/plugin-template/.claude-plugin/plugin.json`** — A complete plugin manifest with ALL optional fields populated. Use the literal plugin name `example-plugin` as a static template (new-plugin.sh in Plan 03 will generate this via jq, not sed-substitute it). Fields:
       - `name`: `"example-plugin"`
       - `version`: `"1.0.0"` (avoids -2 pre-1.0 deduction)
       - `description`: `"A Claude Code plugin that does something useful"` (>= 20 chars)
       - `author`: `{ "name": "Your Name" }`
       - `homepage`: `"https://github.com/YOUR-USERNAME/example-plugin"` (placeholder URL, not empty string — empty string triggers -2 deduction)
       - `repository`: `"https://github.com/YOUR-USERNAME/example-plugin"` (same)
       - `license`: `"MIT"`
       - `keywords`: `["claude-code", "plugin"]`
       - `commands`: `["./commands/example.md"]`
       - `agents`: `["./agents/example-plugin-example-agent.md"]`

    2. **`templates/plugin-template/agents/example-plugin-example-agent.md`** — An example agent file. Must use the prefix `example-plugin-` to establish the naming convention (Rule 20). Content should be a minimal but valid agent definition with YAML frontmatter (name, description, tools) and a short role description.

    3. **`templates/plugin-template/commands/example.md`** — An example command file. Content should demonstrate the command markdown format with a brief description and usage section.

    4. **`templates/plugin-template/CLAUDE.md`** — Development guidance file. Include placeholder sections: plugin name/description, architecture overview, key commands, and development notes. Use `{{PLUGIN_NAME}}` and `{{PLUGIN_DESCRIPTION}}` as substitution placeholders where appropriate.

    5. **`templates/plugin-template/README.md`** — Must be >= 50 lines (Rule 11 threshold). Include sections: title, badges placeholder, description, installation, usage, commands, agents, configuration, contributing, and license. Use `{{PLUGIN_NAME}}` and `{{PLUGIN_DESCRIPTION}}` placeholders.

    6. **`templates/plugin-template/CHANGELOG.md`** — Initial changelog. Include a `## [1.0.0]` entry with "Initial release" content.

    7. **`templates/plugin-template/VERSION`** — Single line: `1.0.0` (must match plugin.json version for Rule 28).

    IMPORTANT: Do NOT create a `skills/` directory (empty dirs incur -2 deduction per research finding). Do NOT include hooks (no hooks means no permission check failures).
  </action>
  <verify>
    Run `./scripts/validate-plugin.sh templates/plugin-template` — must exit 0. (Level 1: Sanity)
    Run `./scripts/score-plugin.sh templates/plugin-template --json | jq .total` — must be >= 40 (hard), target >= 90 (stretch). (Level 1: Sanity)
    Count README.md lines: `wc -l templates/plugin-template/README.md` — must be >= 50.
    Verify plugin.json is valid JSON: `jq . templates/plugin-template/.claude-plugin/plugin.json` succeeds.
  </verify>
  <done>Template directory exists with 7 files, passes validation (exit 0), and scores >= 90 on quality rubric. No empty artifact directories. All declared paths in plugin.json resolve to existing files.</done>
</task>

<task type="auto">
  <name>Task 2: Create validate-local.sh wrapper script</name>
  <files>scripts/validate-local.sh</files>
  <action>
    Create `scripts/validate-local.sh` — a local validation wrapper that contributors run before submitting a PR.

    Follow the existing script conventions from validate-plugin.sh and score-plugin.sh:
    - Shebang: `#!/usr/bin/env bash`
    - `set -euo pipefail`
    - `SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"`
    - `REPO_ROOT="$(cd "$SCRIPT_DIR/.." && pwd)"`

    Script behavior:
    1. Accept one required argument: `<plugin-dir>` (path to the plugin directory)
    2. If no argument or `--help`, print usage and exit 2 (consistent with other scripts)
    3. Resolve relative paths to absolute: if `$PLUGIN_DIR` doesn't start with `/`, resolve via `cd + pwd`
    4. Check that the directory exists; exit 2 with clear error if not
    5. Run `$SCRIPT_DIR/validate-plugin.sh "$PLUGIN_DIR"` — if it fails, print "VALIDATION FAILED" and exit 1
    6. Print a blank line separator
    7. Run `$SCRIPT_DIR/score-plugin.sh "$PLUGIN_DIR"` — always run even if it returns non-zero (use `|| true` since scoring is informational)
    8. Print a summary line at the end: "Local validation complete."

    Make the script executable: `chmod +x scripts/validate-local.sh`.

    IMPORTANT: No `sed -i`, no Bash 4+ features, no GNU-specific flags.
  </action>
  <verify>
    Run `./scripts/validate-local.sh plugins/GRD` — must exit 0 and show both validation and scoring output. (Level 1: Sanity)
    Run `./scripts/validate-local.sh plugins/multi-cli-harness` — must exit 0. (Level 1: Sanity)
    Run `./scripts/validate-local.sh` with no args — must print usage and exit 2.
    Run `./scripts/validate-local.sh /nonexistent` — must print error and exit 2.
    Run `./scripts/validate-local.sh templates/plugin-template` — must exit 0 (validates the template itself). (Level 1: Sanity)
    Verify existing fixture tests still pass: `./scripts/run-fixture-tests.sh` (Level 1: Sanity)
  </verify>
  <done>validate-local.sh exists, is executable, runs validation + scoring on any plugin directory, exits 0 for valid plugins, exits 2 on bad args, and does not break existing fixture tests.</done>
</task>

</tasks>

<verification>
Level 1 (Sanity):
- `./scripts/validate-plugin.sh templates/plugin-template` exits 0
- `./scripts/score-plugin.sh templates/plugin-template --json | jq .total` >= 40
- `./scripts/validate-local.sh plugins/GRD` exits 0
- `./scripts/validate-local.sh templates/plugin-template` exits 0
- `./scripts/run-fixture-tests.sh` still passes (no regression)

Level 2 (Proxy):
- Template README.md has >= 50 lines
- Template plugin.json parses cleanly with `jq .`
- Template agent file uses `example-plugin-` prefix
- validate-local.sh handles edge cases (no args, bad path)
</verification>

<success_criteria>
- templates/plugin-template/ directory contains 7 files across .claude-plugin/, agents/, commands/, and root
- Template passes validation and scores >= 90 on the quality rubric
- validate-local.sh works on all existing plugins and the template itself
- No existing tests are broken (run-fixture-tests.sh passes)
- No Bash 4+ features, no sed -i, no GNU-specific flags in any new file
</success_criteria>

<output>
After completion, create `.planning/phases/04-onboarding-automation/04-01-SUMMARY.md`
</output>
